<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Training & P2P — Naloxone Advocates</title>
  <meta name="description" content="Book free naloxone training sessions in Plymouth and Devon." />
  <link rel="stylesheet" href="/assets/css/styles.cssv (optional – match your site) -->
  <header class="site-header">
    <div class="container">
      <a class="brand"ts/img/logo.svg" alt Advocates</span></a>
      <nav class="nav">
        <a href="/about.html
        <a href="/htmlTraining & P2P</a>
        /resources.htmlResources</a>
        <a href="/news</a>
        <a class="btn btn--primary" href="/contact.html</div>
  </header>

  <!-- HERO -->
  <section class="hero">
    <div class="container">
      <h1>Book Free Naloxone Training</h1>
      <p>Choose a session and submit your details. We’ll confirm by email.</p>
    </div>
  </section>

  <!-- BOOKING FORM (posts to your Google Apps Script Web App) -->
  <section class="section" id="book">
    <div class="container">
      <form id="bookingForm" class="card" style="padding:20px">
        <div class="grid-2" style="grid-template-columns:1fr 1fr; gap:14px">
          <div>
            <label for="full_name">Full name *</label><br>
            <input id="full_name" name="full_name" type="text" required placeholder="Jane Doe"
                   style="width:100%;padding:12px;border-radius:10px;border:1px solid #d8def0">
          </div>
          <div>
            <label for="email">Email *</label><br>
            <input id="email" name="email" type="email" required placeholder="you@example.org"
                   style="width:100%;padding:12px;border-radius:10px;border:1px solid #d8def0">
          </div>
          <div>
            <label for="phone">Phone</label><br>
            <input id="phone" name="phone" type="tel" placeholder="+44 ..."
                   style="width:100%;padding:12px;border-radius:10px;border:1px solid #d8def0">
          </div>
          <div>
            <label for="session">Choose a session *</label><br>
            <select id="session" name="session" required
                    style="width:100%;padding:12px;border-radius:10px;border:1px solid #d8def0">
              <option value="">Select…</option>
              <option>Community Session — Harbour Centre</option>
              <option>Peer‑to‑Peer (P2P) — Devonport</option>
              <option>Organisational Training — On‑site</option>
            </select>
          </div>
          <div>
            <label for="date">Preferred date *</label><br>
            <input id="date" name="date" type="date" required
                   style="width:100%;padding:12px;border-radius:10px;border:1px solid #d8def0">
          </div>
          <div>
            <label for="attendees">Number of attendees</label><br>
            <input id="attendees" name="attendees" type="number" min="1" max="50" value="1"
                   style="width:100%;padding:12px;border-radius:10px;border:1px solid #d8def0">
          </div>
          <div style="grid-column:1/-1">
            <label for="notes">Notes</label><br>
            <textarea id="notes" name="notes" rows="4"
                      placeholder="Accessibility needs, organisation name, anything else…"
                      style="width:100%;padding:12px;border-radius:10px;border:1px solid #d8def0"></textarea>
          </div>
        </div>

        <!-- Honeypot anti‑spam (hidden field; should stay empty) -->
        <input type="text" name="website" id="website" style="display:none">

        <div class="cta-row" style="margin-top:14px">
          <button class="btn btn--pink" type="submit">Submit Booking</button>
          <span id="formStatus" style="margin-left:12px;color:#58627a"></span>
        </div>
      </form>
    </div>
  </section>

  <!-- VOLUNTEER SIGN-UP (optional) -->
  <section class="section" id="volunteer">
    <div class="container">
      <h2>Volunteer Sign‑Up</h2>
      <p>Help with outreach, events, peer training, or behind the scenes.</p>
      <!-- You can duplicate the same form with different endpoint/columns if needed -->
      <!-- Or embed a Google Form iframe here -->
    </div>
  </section>

  <footer class="site-footer"><div class="container">© Naloxone Advocates Plymouth CIC</div></footer>

  <!-- Client-side handler that posts to Google Apps Script -->
  <script>
    // Your Apps Script Web App URL:
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyckpp9ACxXNftfL0lHp5lIXq1axq-VF_XG3xzaadjvre_ee_Qa2DU0baBlyg-YYLWIHQ/exec';

    const form = document.getElementById('bookingForm');
    const statusEl = document.getElementById('formStatus');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      statusEl.style.color = '#58627a';
      statusEl.textContent = 'Sending…';

      // basic spam check
      if (form.website && form.website.value) {
        statusEl.style.color = '#c0392b';
        statusEl.textContent = 'Submission blocked.';
        return;
      }

      const data = Object.fromEntries(new FormData(form).entries());
      data._source = 'NAP Website';

      try {
        const res = await fetch(APPS_SCRIPT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        const json = await res.json().catch(() => ({}));
        if (res.ok && (json.ok !== false)) {
          statusEl.style.color = '#27c383';
          statusEl.textContent = json.message || 'Thanks — your booking has been received.';
          form.reset();
        } else {
          throw new Error(json.message || 'Could not submit. Please try again.');
        }
      } catch (err) {
        statusEl.style.color = '#c0392b';
        statusEl.textContent = err.message || 'Network error. Please try again.';
      }
    });
  </script>
</body>
</html>
